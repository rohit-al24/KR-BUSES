import { v4 as uuidv4 } from 'uuid';
import fs from 'node:fs';
import path from 'node:path';

// Expanded dummy dataset: students, staff (faculty), drivers and routes (buses).
// Every student and staff below is assigned to a route so the buses cover the whole population.

export const students = []; // will be populated from uploaded CSV (if present) or parsed fallback CSV

export const staff = [
  { id: uuidv4(), name: 'Dr. Carol Lee', email: 'carol.lee@gmail.com', dob: '1980-07-20', role: 'staff', route: 101 },
  { id: uuidv4(), name: 'Mr. Dan Brown', email: 'dan.brown@gmail.com', dob: '1975-02-14', role: 'staff', route: 102 },
  { id: uuidv4(), name: 'Mrs. Priya Singh', email: 'priya.singh@gmail.com', dob: '1985-11-30', role: 'staff', route: 103 },
  { id: uuidv4(), name: 'Dr. Anil Menon', email: 'anil.menon@gmail.com', dob: '1978-04-05', role: 'staff', route: 104 },
  { id: uuidv4(), name: 'Ms. Radha Iyer', email: 'radha.iyer@gmail.com', dob: '1982-09-19', role: 'staff', route: 105 },
  { id: uuidv4(), name: 'Prof. K Kavitha', email: 'k.kavitha@gmail.com', dob: '1976-01-08', role: 'staff', route: 106 }
];

export const drivers = [];

// Buses / routes. Each route includes a driver name and a list of students assigned.
export const routes = [];

// Initialize attendance array on each route
routes.forEach((r) => {
  r.attendance = []; // each entry: { date, count, submittedBy, submittedAt }
});

// --- Begin CSV import (class roster) -----------------------------------
// The attached CSV (exported from the registrar) is embedded below and parsed
// to create additional student entries and add any missing route records.
const csvText = `
,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,
,,,,,,,,CLASS ADVISOR :,M.BHARATHI,,,,,,,,
,,,,,,,,ASST CLASS ADVISOR :,NIL,,,,,,,,
,,,,,,,,CLASS REPRESENTATIVE (BOYS):,ELAVALAGAN P,,,,,,,,
,,,,,,,,CLASS REPRESENTATIVE (GIRLS):,KOUSHIHA R,,,,,,,,
,,,,,,,,CLASS ROOM NUMBER :,LHC 201,,,,,,,,
,,SL.NO,ROLL NO,REG NO,NAME,GENDER,REGULAR/LATERAL,DAY SCHOLAR / HOSTEL,IF DAY SCHOLAR BUS BOARDING POINT,BUS NUMBER,HOSTEL ROOM NUMBER,ADDRESS LINE 1,ADDRESS LINE 2,ADDRESS LINE 3,STUDENT MOBILE NUMBER,PARENTS MOBILE NUMBER,STUDENT MAIL ID
,,1,AM2401,2403811714821001,AADHEESWARAN B,MALE,REGULAR ,HOSTEL,,,1414,4/215,SOUTH STREET ,PERUVALAPPUR,8248343956,9655006216,aadheeswaran.al24@krct.ac.in
,,2,AM2402,2403811714821002,ABRAHAM ROBERT C,MALE,Regular ,Day Scholar,Senthaneerpuram ,12,,No 6,Senthaneerpuram ,"Lal bhadur sastri street , Trichy ",9629355090,9345499925,abrahamrobert.al24@krct.ac.in
,,3,AM2403,2403811714822003,ALSHIFAA M,Female,Regular,Day Scholar,Thuvakudi Palpannai,4,,"#41,#42",Dhanarathinam Nagar,"5th cross street,Mahalakshmi nagar",trichy,6374197037,alshifaa.al24@krct.ac.in
,,4,AM2404,2403811714822004,AMEERA H,,,,,,,,,,,,
,,5,AM2405,2403811714822005,ANJANA S G,FEMALE,REGULAR ,HOSTEL,,,100,139/1,"Sri Ram nagar,thiruvaiyaru",Tanjore ,8610007411,8880358654,anjana.al24@krct.ac.in
,,6,AM2406,2403811714822006,ASHWINI B,FEMALE,regular,day scholar,palur,5,,3/254,kst palur koothur(po) manachanallur,Trichy,9345847263,9788037081,ashwini.al24@krct.ac.in
,,7,AM2407,2403811714821007,BARATH S,MALE,REGULAR,DAY SCHOLAR,RAJA THEATRE ,7,,NO.3,VEDHATHRI NAGAR,E.B.ROAD TRICHY-8,9629316651,9789166651,barath.al24@krct.ac.in
,,8,AM2408,2403811714821008,DAYANIDI M A,MALE,REGULAR ,DAY SCHOLAR,LALGUDI,23,,44/2,"ISWARYA NAGAR ,A K NAGAR WEST EXTENSION ",LALGUDI ,7708740211,9952904038,dayanidi.al24@krct.ac.in
,,9,AM2409,2403811714821009,DHILIPAN G,MALE,REGULAR ,HOSTEL ,,,1425,NO.314,EB COLONY AROKIYA NAGAR 5TH STREET ,,,,
,,10,AM2410,2.40381E+15,DHIVSHIKH S K,MALE,REGULAR,DAY SCHOLAR,U.K.T MALAI,26,,NO.69,SHANMUGA NAGAR WEST EXTENSION,3rd 'A' cross U.K.T MALAI,7812895985,7639000600,dhivshikh.al24@krct.ac.in
,,11,AM2411,2403811714821011,ELAVALAGAN P,,,,,,,,,,,,
,,12,AM2412,2403811714822012,GNANAMAHADEVI M,FEMALE,REGULAR ,HOSTEL ,,,20,"46,KALYAN NAGAR",THURAIYUR ROAD,PERAMBALUR ,9500201489,9965055544,gnanamahadevi.al24@krct.ac.in
,,13,AM2413,2403811714822013,HAMSIKA SRI S M,FEMALE,REGULAR ,HOSTEL ,,,98,NO.1,KON PALAYAM ,PATTUKKOTTAI,6382909687,9443972636,hamsikasri.al24@krct.ac.in
,,14,AM2414,2403811714822014,HEMSHREE S,,,,,,,,,,,,
,,15,AM2415,2403811714822015,INIYA MOHAN SUMATHI,FEMALE,REGULAR,DAY SCHOLAR,RETTAI VAIKAL,27,,2/122,JYOTHI NAGAR,NACHIKURUCHI,8668194216,8778477954,iniya.al24@krct.ac.in
,,16,AM2416,2403811714821016,JAGATHEESWARAN T,MALE,REGULAR,DAY SCHOLAR,PONMALAIPATTI,54,,4/513,ADAIKALA ANNAI NAGAR,PONMALAIPATTI,7708794694,9715939186,jagatheeswaran.al24@krct.ac.in
,,17,AM2417,2403811714822017,JANANI A,FEMALE,REGULAR,OUT BUS,,,,6/164,THENNAMARA SOLAI,PUDUR UTHAMANUR,9629926318,9047531581,Janania.al24@krct.ac.in
,,18,AM2418,2403811714822018,JANANI P,FEMALE,REGULAR ,HOSTELER,,,39/OB,1/7 Arugampalayam,Bharathidhasan Nagar Thanthonimalai,Karur-7,6379899059,9843568359,jananip.al24@krct.ac.in
,,19,AM2419,2403811714822019,JEEVITHA S,FEMALE ,REGULAR ,DAY SCHOLAR ,RAJA THEATRE,25,,"Middle white betal street, near periya kadai veedhi,Trichy-08 ",,,9342264043,6381976562,jeevitha.al24@krct.ac.in 
,,20,AM2420,2.40381E+15,JOSHIKA SREE R,FEMALE,REGULAR,DAY SCHOLAR ,ANNA SALAI ,1,,C BLOCK  FIRST FLOOR ,VIGNESH GARDEN ,MELA CHINTAMANI ,9789635357,9994289057,joshikasree.al24@krct.ac.in
,,21,AM2421,2403811714821021,JUDSON ASAPH H,,,,,,,,,,,,
,,22,AM2422,2403811714821022,KAMALESH R,,,,,,,,,,,,
,,23,AM2423,2403811714822023,KANISHKA M,FEMALE,REGULAR,DAY SCHOLAR,Rajakopuram,41,,132,"East Adayavalanjan street, Srirangam",Trichy-6,6374263755,9443582511,kanishka.al24@krct.ac.in
,,24,AM2424,2403811714822024,KAVIYADHARSHINI V,Female ,Regular ,Hosteler,,,36/OB,"mariyaman Kovil Street,usilampatti Main road , vikiramangalam ",,,6385292994,9597842994,kaviyadharshini.al24@krct.ac.in
,,25,AM2425,2403811714821025,KOKILAN A,MALE,REGULAR,OUT BUS,,,,NO 12,THIRUMALAI NAGAR,"NO1 TOLGATE,TRICHY,621216",6380046014,6380046014,kokilan.al24@krct.ac.in
,,26,AM2426,2403811714822026,KOUSHIHA R,,,,,,,,,,,,
,,27,AM2427,2403811714822027,MAHALAKSHMI K,FEMALE,REGULAR,DAY SCHOLAR,MARUTHI NAGAR,16,,"NO.18,SOUNDARYA",VASANTHA NAGAR,MARUTHI NAGAR,6381971725,9786581906,mahalakshmi.al24@krct.ac.in
,,28,AM2428,2403811714822028,MAHESWARI M,Female,Regular ,Day Scholar ,Thillai nagar 11th cross,14,,5th cross,Anna nagar,Trichy Tennur,6369368417,9786666012,maheswari.al24@krct.ac.in
,,29,AM2429,2403811714822029,MANIMALAR T,,,,,,,,,,,,
,,30,AM2430,2.40381E+15,MANTRAA G,Female,Regular,Day Scholar,Mannachanallur Kadaiveethi,37,,20/83,mela chetty street,Mannachanallur ,8248794040,9965241375,mantraa.al24@krct.ac.in
,,31,AM2431,2403811714822031,MERUDULA S,Female,Regular,Day Scholar ,Nadarchatram,30,,104,Balaji Nagar,Somarasampettai ,9677114379,9629560009,merudula.al24@krct.ac.in
,,32,AM2432,2403811714821032,MOHAMMED IRFHAN R,MALE,REGULAR,DAY SCHOLAR,TENNUR,14,,12,VELLALA STREET,TENNUR,8838696794,8098367303,mohammedirfhan.al24@krct.ac.in
,,33,AM2433,2403811714821033,MUHAMMAD IMRAN S,MALE,Regular ,Days scholar ,,,,1/138,Pallivasal street,"T.kalathur, Perambalur DT",9043021500,9566839774,muhammadimran.al24@krct.ac.in
,,34,AM2434,2403811714822034,NAGAMUTHU AGALYA S,FEMALE,REGULAR ,DAY SCHOLAR,THUVAKUDI PALPANNAI,4,,43,SOUTH THARANALLUR ,ALANGANATHAPURAM ROAD TRICHY,6369035875,9994824287,nagamuthuagalya.al24@krct.ac.in
,,35,AM2435,2403811714821035,NAVEEN R,,,,,,,,,,,,
,,36,AM2436,2403811714822036,NIVEETHAA P,FEMALE ,REGULAR ,HOSTELER ,      ,,15/NB,"No2,12th Cross",ANBU NAGAR,CRAWFORD ,6381447425,9842778472,niveethaa. al24@krct.ac.in 
,,37,AM2437,2403811714822037,PRATHIBA B,FEMALE ,REGULAR ,DAY SCHOLAR ,ANNASALAI,1,,2/210 A,PUTHAPURAM ,"SARKARPALAYAM ,KALLANAI ",6383603057,9750314363,Prathiba.al24@krct.ac.in
,,,,,,,,,,,,,,,,,
,,38,AM2438,2403811714822038,PREETHI B,FEMALE ,REGULAR,DAY SCHOLAR,KAMBARASAMPETTAI ,10,,47/2,KAVERI NAGAR,KAMBARASAMPETTAI ,9443573196,9486373196,Preethi.al24@krct.ac.in
,,39,AM2439,2403811714822039,RAGAVI B,,,,,    ,,,,,,
,,40,AM2440,2.40381E+15,RAGUL S,,,,,,,,,,,,
,,41,AM2441,2403811714821041,RAKHUL GAJAN S P,MALE,REGULAR ,DAY SCHOLAR,RUKMANI THEATRE ,3,,NO.03,kamatchi amman Nagar ,mudaliar street woraiyur trichy,9789930118,9789165056,rakhulgajan.al24@krct.ac.in
,,42,AM2442,2403811714821042,ROHIT S K,MALE,REGULAR ,DAY SCHOLAR ,RAJA THEATRE,7,,"No.7, S.P.illam,",Beeranki Tank street,Trichy - 8,7695837343,9842482510,rohit.al24@krct.ac.in
,,43,AM2443,2403811714822043,ROOPALAKSHMI KAVINSANDRON,FEMALE ,REGULAR ,DAY SCHOLAR,K K NAGAR,44,,No 32 Thangaiah Nagar ,18th cross cut extension ,K K nagar Trichy 21,7845820046,9443810859,roopalakshmi.al24@krct.ac.in
,,44,AM2444,2403811714821044,ROSHAN P,MALE,REGULAR,DAY SCHOLAR,out bus,,,2/44,periyar street,"keelakalkandarkottai , trichy -11",9524512692,9087762790,roshan.al24@krct.ac.in
,,45,AM2445,2403811714822045,SADHURYA A,,,,,,,,,,,,
,,46,AM2447,2403811714821047,SHANMUGAM B R,MALE,REGULAR,HOSTELER,,,1402,NO.24,EAST ADICHERRY STREET,"KODAVASAL,THIRUVARUR DT",9025612544,7010584157,shanmugam.al24@krct.ac.in
,,47,AM2448,2403811714821048,SHARUKK HASTHIK M,MALE,REGULAR ,DAY SCHOLAR,SABARI MILL,17,,NO.9,SUBRAMANIYAM STREET,"AYYAPA NAGAR,KK NAGAR,TRICHY-21",7397659126,9994970720,sharukkhasthik.al24@krct.ac.in
,,48,AM2449,2403811714821049,SHRI LOGESH S,MALE,REGULAR,DAY SCHOLAR,BIKSHANDAR KOVIL,5,,5/1299,MANGALA NAGAR , BIKSHANDAR KOVIL,8667476578,9488977869,shrilogesh.al24@krct.ac.in
,,49,AM2450,2.40381E+15,SHYAM GR,MALE,REGULAR,HOSTELER,,,1411,21,BHARATHI NAGAR ,FIRST STREET ALAGAPPAPURAM KARAIKUDI,9095905973,9488605973,shyam.al25@krct.ac.in
,,50,AM2451,2403811714822051,SRI VARSHANA,,,,,,,,,,,,
,,51,AM2452,2403811714821052,STEVE WAUGH J,MALE, REGULAR,DAY SCHOLAR,WEREHOUSE,25,,NO 3,ALAM STREET,"KHAJAPETTAI,TRICHY-1",9385660975,9489766810,stevewaugh.al24@krct.ac.in
,,52,AM2453,2403811714822053,SUBHI FELCIA F,FEMALE,REGULAR,HOSTELER,,,36/NB,Ts No:9485/10,"Rajagopalapuram,3rd Street",Pudukkottai,8610461187,9994040820,subhifelcia.al24@krct.ac.in
,,53,AM2454,2403811714821054,SUDHARSAN R,MALE,,Day Scholar,New bus stand,39,,"984B, ","Ranivaikkal lane, North","Main Street, Thanjavur",9043190564,9790125204,sudharsan.al24@krct.ac.in
,,54,AM2455,2403811714821055,SURIYA R G,MALE,REGULAR,Day SCHOLAR,indian bank,33,,"117,7th street",moogambigai nagar,melakalkandar kottai,9092938155,9842357152,suriya.al24@krct.ac.in
,,55,AM2456,2403811714822056,SUSHMITHA S,,,,,,,,,,,,
,,56,AM2457,2403811714822057,VADIVAZHAGI R,Female ,REGULAR,HOSTELER ,,,45,19,PARAPPATTI ROAD,"KEERANUR, PUDUKOTTAI , 622502",8525010812,9047395964,vadivazhagi.al24@krct.ac.in
,,57,AM2458,2403811714821058,VIGNESH K M,male,regular,Day  Scholar,palur,5,,2702/A valavandha puram,Pichandar kovil,"No.1. Tollgate, trichy",9344909373,9626635969,vignesh.al24@krct.ac.in
,,58,AM2460,2.40381E+15,VISEKA S,Female ,Regular ,HOSTELER ,,,36,,,,,,
,,59,AM2461,2403811714821061,VISHAL R,MALE,REGULAR,DAY SCHOLAR,MANJADHIDAL PALAM,50,,1/105 MARIYAMMAN KOVIL STREET,"ELLAKUDY,KATTUR",TRICHY-19,9677441180,7092523568,vishal.al24@krct.ac.in
,,60,AM2462,2403811714821062,VISHWAJITH P,MALE,REGULAR,DAY SCHOLAR,GOLDEN BAKERY,51,,"24 , GANDHI NAGAR",2nd STREET,"MUSIRI TK , TRICHY DT , 621211",6385339996,7502553402,vishwajith.al24@krct.ac.in
,,61,AM2463,2403811714821063,WILSON S,Male,regular,days scholar,New bus stand,39,,123/2041 palaniyapa nagar 4th cross nk road,nagar 4th cross NK road thanjavur,thanjavur 613006,8220412269,8072965815,wilson.al24@krct.ac.in
`;

// Additional roster provided by user (appended to embedded CSV).
const extraCsv = `
S.NO,ROLL.NO,NAME OF THE STUDENT,BOARDING POINT,"BUS NO.",GENDER
1,ADA24001,ABETHA M K,Kulumani,9,Female
2,ADA24002,ACHUTHAN G K R,BISHOP COLLEGE,26,Male
3,ADA24003,ADARSHINI M,Thombankudisai,50,Female
4,ADA24004,AJAI ANTONI M,Ponmalaipatti,27,Male
5,ADA24006,ANANTH P,THURAIYUR ,28,Male
6,ADA24011,ASWATHI S,Raja Theatre,25,Female
7,ADA24014,BHAVADHARANI S,Training Centre,40,Female
8,ADA24016,CHANDRU R,MELAPUDUR,27,Male
9,ADA24017,DHARSAN SANJAY G,MANNARPURAM,18,Male
10,ADA24019,DHARUNRAJ N,SOMARASAMPETTAI,26,Male
11,ADA24021,DINESH KRISHNAMOORTHY R,NATHARMALAI,47,Male
12,ADA24022,DINESH M,NEW TOWN,38,Male
13,ADA24026,GEETHAN K,SIPCOT,37,Male
14,ADA24028,HARIHARAN R,PERAMBALUR,22,Male
15,ADA24029,HARIHARAVASAN V,PETTAVAITHALAI BUS STAND,32,Male
16,ADA24033,HEMNATH A,THIRUVELLARAI,44,Male
17,ADA24036,JANANI M,THURAIYUR,49,Female
18,ADA24039,JASVANTH A,Melapandamangalm,2,Male
19,ADA24041,JAYALAKSHMI M,KAMARAJAR ARCH ,22,Female
20,ADA24042,KANCHANA DEVI S,Pettavaithalai,32,Female
21,ADA24043,KANISHYA M,Palakarai,52,Female
22,ADA24044,KARTHEESH AROKIYA BOOPATHY,Marsingpet,29,Male
23,ADA24045,KAVILAKSHMI B,NEW BUS STAND THANJAVUR,36,Female
24,ADA24046,KAVIN ADHITHYA A S,SHANMUGA NAGAR,26,Male
25,ADA24048,KAVIYA K,PERAMAGALAM,49,Female
26,ADA24049,KELVIN SAMUEL I,OIL MILL,35,Male
27,ADA24050,KIRUBASRI.A,Mambalasalai,41,Female
28,ADA24051,KIRUTHICK SELVAN S,THANJAVUR NEW BUS STAND,36,Male
29,ADA24052,KODESHWARI K,PETTAVAITHALAI,10,Female
30,ADA24054,LATHIKA M,VANDIKARA STREET,50,Female
31,ADA24055,LOGESH R,MANNARPURUM,18,Male
32,ADA24057,LOKESHWARAN V,PICHANDARKOVIL,5,Male
33,ADA24058,MAHALAKSHMI K R,RETTAIVAIKAL,42,Female
34,ADA24062,MOHAMED ASIL M,Beema Nagar,27,Male
35,ADA24063,MOHAMED RASHEED R,HOSTEL STOP K. K NAGAR,17,Male
36,ADB24064,MOHANASELVAN KATHIRESAN,PULLAMBADI,15,Male
37,ADB24066,MONISH DARRIUS A V,K.K.NAGAR,17,Male
38,ADB24068,MOULISHWARAN B,T.V.kovil,"37,50",Male
39,ADB24069,NICKSON A,NAGAMANGALAM,18,Male
40,ADB24071,OMNITHISH CHANDRAMOHAN,THIRUVANIKOIL,"37,50",Male
41,ADB24072,OVIYA P,NEW BUS STAND - THANJAVUR,36,Female
42,ADB24075,PRADEEP K,WORAIYUR,3,Male
43,ADB24077,PRAGADESHWARAN R,CHATRAM BUS STAND,77,Male
44,ADB24079,PRASHANTH G,CONVENT,50,Male
45,ADB24082,PRITHIKA M,THIRUKKATTUPALLI,23,Female
46,ADB24084,PRIYADHARSHINI B,CHATRAM BUS STAND,1,Female
47,ADB24087,RABIN RICHARD F,MATHUR BUS STAND,48,Male
48,ADB24088,RAHUL M,THIRUVANAIKOVIL,"37,50",Male
49,ADB24091,RENGANAYAKI G,RUKUMANI STOP-WORAIYUR,42,Female
50,ADB24092,RISHI P S,PONMALAI,21,Male
51,ADB24093,RISHIKA K S,Karuveapilayan gate,47,Female
52,ADB24096,SABAREESHWARAN N,OLD PALPANNAI,36,Male
53,ADB24097,SACHIN M,K.K.NAGAR,17,Male
54,ADB24098,SANTHOSHKUMAR S,MIET,19,Male
55,ADB24099,SANTHOSHMANI S,WORAIYUR,3,Female
56,ADB24101,SARAVANA KUMAR S,Koppavali,23,Male
57,ADB24105,SHANMUGA PRIYAN K S,New Bus Stand(Thanjavur),39,Male
58,ADB24106,SHANMUGANATHAN KARNAN,SOMARASAMPETTAI,26,Male
59,ADB24107,SHARMILA N,MANNACHANALLUR ,44,Female
60,ADB24111,SRI TEJASWINI SU,KK Kottai,33,Female
61,ADB24114,STENILA P,KEELAKANDAR KOTTAI,33,Female
62,ADB24115,SUJAN K,CHATRAM BUS STAND,1,Male
63,ADB24116,SUPRAJA J,SRIRANGAM ,41,Female
64,ADB24118,SYED SHAMMEER S A,Woraiyur,3,Male
65,ADB24120,THARIKA M,PALAKKARAI,8,Female
66,ADB24122,THISANTH S,PANNADIYAN KOVIL,34,Male
67,ADB24123,VARSHA A,MANDURAI,31,Female
68,ADB24124,VIGNESH K,KADAIVETHI BG NAIUDU ROAD,42,Male
69,ADB24125,VISALI BAGAVATHI S,WAREHOUSE ,25,Female
70,ADB24126,YAEKNTH S,SRIRANGAM,41,Male
71,AM2402,ABRAHAM ROBERT C,SENTHANEERPURAM BUS STAND,33,Male
72,AM2403,ALSHIFAA M,"PALPANNAI,THUVAKKUDI",37,Female
73,AM2404,AMEERA H,MADAM ,33,Female
74,AM2406,ASHWINI B,PALUVOOR,19,Female
75,AM2407,BARATH S,RAJA THEATRE,25,Male
76,AM2410,DHIVSHIKH S K,U.K.T.Malai,26,Male
77,AM2411,ELAVALAGAN P,MELAKALKANDARKOTTAI,33,Male
78,AM2414,HEMSHREE S,PETTAVAITHALAI ANNA NAGAR SBI BANK OPPOSITE ,32,Female
79,AM2415,INIYA MOHAN SUMATHI,RETTAI VAAIKAL,42,Female
80,AM2416,JAGATHEESWARAN T,PONMALAIPATTI,21,Male
81,AM2419,JEEVITHA S,RAJA THEATER,25,Female
82,AM2420,JOSHIKA SREE R,ANNA SALAI,1,Female
83,AM2421,JUDSON ASAPH H,MANNARPURAM,18,Male
84,AM2422,KAMALESH R,Poondi,23,Male
85,AM2423,KANISHKA M,SRIRANGAM,29,Female
86,AM2425,KOKILAN A,MARUTHI NAGAR,26,Male
87,AM2426,KOUSHIHA R,MUSURI,32,Female
88,AM2427,MAHALAKSHMI K,MARUTHI NAGAR,5,Female
89,AM2428,MAHESWARI M,Thillai Nagar 11th cross,14,Female
90,AM2429,MANIMALAR T,Pichandavar Koil,5,Female
91,AM2430,MANTRAA G,CHIDAMBARAM PILLAI COLLEGE ,44,Female
92,AM2431,MERUDULA S,NADASATHRAM,30,Female
93,AM2432,MOHAMMED IRFHAN R,11TH CROSS THILLAI NAGAR,14,Male
94,AM2434,NAGAMUTHU AGALYA S,"THUVAKUDI, PALPANNAI",34,Female
95,AM2437,PRATHIBA B,ANNASALAI,1,Female
96,AM2438,PREETHI B,"KAVERI NAGAR,KAMBARASAMPETTAI",20,Female
97,AM2441,RAKHUL GAJAN S P,Rukmani bus stop ,42,Male
98,AM2442,ROHIT S K,SINGARATHOPPU,25,Male
99,AM2443,ROOPALAKSHMI KAVINSANDRON,K K Nagar,12,Female
100,AM2444,ROSHAN P,PERAMBALUR,46,Male
101,AM2448,SHARUKK HASTHIK M,Sabari Mill,17,Male
102,AM2449,SHRI LOGESH S,PICHANDAR KOVIL,5,Male
103,AM2451,SRI VARSHANA,OIL MILL,35,Female
104,AM2452,STEVE WAUGH J,Melaputhur,25,Male
105,AM2454,SUDHARSAN R,THANJAVUR - NEW BUS STAND,36,Male
106,AM2455,SURIYA R G,AATHUPALAM,33,Male
107,AM2456,SUSHMITHA S,RAMBA THEATRE,1,Female
108,AM2458,VIGNESH K M,PALUR,5,Male
109,AM2461,VISHAL R,MANJATHIDAL PALAM,38,Male
110,AM2462,VISHWAJITH P,MUSURI,51,Male
111,AM2463,WILSON S,Thanjavur New Bus Stand,36,Male
112,CE2401,ADHITHIYA G,Mannachanallur,44,Male
113,CE2402,AJAY AKAASH S,ALATHUR,33,Male
114,CE2403,AMUTHARASAN R,PERAMBALUR,46,Male
115,CE2404,ARASI T,NEAR COLLECTOR OFFICE THANJAVUR ,36,Female
116,CE2408,DEEPASHREE P,SANGUPETTAI- PERAMBALUR,22,Female
117,CE2410,GOWTHAM K,THURAIYUR,52,Male
118,CE2411,HARISH KUMAR V,SINGARATHOPE,25,Male
119,CE2416,KARTHIKEYAN R,THURAIYUR,49,Male
120,CE2425,LOGESH N,PALLUR,5,Male
121,CE2429,MITHUN CHAKRAVARTHY K,ALLUR MELATHERU,32,Male
122,CE2430,MOHAMED SUBAN,EDAMALIPATTI PUDUR ,18,Male
123,CE2433,NETHRA V K,PERIYAR STREET,49,Female
124,CE2434,PRANESH SELVARAJ,NACHIKURUCHI,26,Male
125,CE2437,PRIYA RANJAN M,CAUVERY NAGAR,20,Male
126,CE2443,SAMEER AHAMED A,RAJA BUS STOP,25,Male
127,CE2444,SANJAY S,Veereshwaram ,41,Male
128,CE2445,SARVESH SARAN M,MALAI KOVIL,38,Male
129,CE2446,SATHIYA VARSHINI S,THANJAVUR,45,Female
130,CE2447,SHALINI S,BUNGLOW STOP PERAMBALUR,46,Female
131,CE2453,THEJASH KANNA S,THUVAKUDI,39,Male
132,CE2455,THIRUMALAIVASAN K,K.K.NAGAR,17,Male
133,CE2456,UMAR HADHIL S,WORIYUR POLICE STATION,3,Male
134,CE2457,VIDHARSHNASRI R,PERIRODU,49,Female
135,CE2459,VISVESWARAN S,KK NAGAR,17,Male
136,CSA24001,AADIL HASAN S ,Lalgudi,31,Male
137,CSA24002,AAFRIN H,Pudukkottai ( palpannai ),47,Female
138,CSA24004,ABARNA A,MELAKALKANDAR KOTTAI,33,Female
139,CSA24006,AKILESHWAR S,SIT,10,Male
140,CSA24009,ANISHA M,Raja theater,25,Female
141,CSA24010,ANISHFATHIMA A,BEEMANAGAR BUS STOP,29,Female
142,CSA24011,ANISHKA S,THURAIYUR,49,Female
143,CSA24012,ANJE NANCY D S,THURAIMANGALAM,46,Female
144,CSA24015,ARAVINDHA KRISHNA V,Anna nagar main road,48,Male
145,CSA24017,ASHMITHA ANANTHAKRISHNAN,"KMC, Tennur",14,Female
146,CSA24018,ASHWANTHIKA T,KOOTHUR,5,Female
147,CSA24023,ATCHAYA G,PINNAVASAL,15,Female
148,CSA24024,BALAJI B,Palur,5,Male
149,CSA24026,BAVISHA R ,Thuraiyur,52,Female
150,CSA24027,CHAITHANYA S S,Anna Salai,1,Male
151,CSA24028,CHARUNETHRA A,Thalakkudi,34,Female
152,CSA24029,CHRISWIN RICHARD V,Ponmalaipatti,27,Male
153,CSA24030,DEEPAK PRIYAN R,PULLAMBADI,15,Male
154,CSA24032,DHANUSH P,RAMACHANDRA NAGAR,18,Male
155,CSA24033,DHANUSU R,MUSIRI,51,Female
156,CSA24035,DHARANI R,THURAIYUR BUS STAND,49,Female
157,CSA24038,DHARSHINI P,THANJAVUR NEW BUS STAND,36,Female
158,CSA24040,DHARSHINI U L,SHANTHI RESTAURANT THURAI MANGALAM,46,Female
159,CSA24041,DHARSHNE D,DEERAN NAGAR,6,Female
160,CSA24042,DHEEKSHA S D,UK THIRUMALAI,30,Female
161,CSA24045,GAJALAKSHMI R K,"NACHIYAL KOVIL , WORAIYUR",3,Female
162,CSA24046,GIRIJA S,BEEMA NAGAR,29,Female
163,CSA24047,HARIHARASUDHAN S,PALAKKARAI,8,Male
164,CSA24049,HARISH BANI M,VALADI sivan kovil,34,Male
165,CSA24050,HARSHAD R,VARASITHI VINAYAGAR TEMPLE,32,Male
166,CSA24053,HASAM BHARATHI KARUNANITHI GOMATHI,LIC colony,12,Female
167,CSA24054,INFANT JOSE H,VAYALUR ROAD RETTAIVAIKKAL,42,Male
168,CSA24055,ISHWARYA K T,MARAKADAI,29,Female
169,CSA24056,JASVANTHAN V G ,TRAINING CENTER ,40,Male
170,CSA24057,JAVITH BASHA J,"KAdai veethi, woraiyur",26,Male
171,CSA24059,JAYASRI J,PULLAMBADI,15,Female
172,CSA24060,JEEVA RANJANI THIRUMAL AZAGAN,K K NAGAR,12,Female
173,CSA24061,JEEVITHA S,PETTAVAITHALAI,41,Female
174,CSA24062,JOSHUA HERALD S,BHEL TRAINING CENTER,40,Male
175,CSB24064,KANISHKA S,RVB School,52,Female
176,CSB24065,KARTHIKEYAN R(08.02.2006),Somarasampettai,26,Male
177,CSB24067,KARUNYA R,"RAIL NAGAR,ARIYAMANGALAM",24,Female
178,CSB24070,KESHIKA A,PALAKKARAI,8,Female
179,CSB24073,KOWSHIK R,MUTHARASANALLUR,32,Male
180,CSB24074,KUMARAN M,THUVAKUDI,39,Male
181,CSB24075,LAKSHIKA V,NADAR CHATIRAM,30,Female
182,CSB24076,LATCHANA C,PULIVALAM,48,Female
183,CSB24077,LATHIKA S,KOTTAPATTU PALPANNAI,7,Female
184,CSB24079,LAWRANCE DURAI V,THURAIYUR VALLI MALIGAI,52,Male
185,CSB24080,LIENCY A,KONALAI BUS STOP,22,Female
186,CSB24082,LOHIND K,SENGIPATTI,39,Male
187,CSB24083,LOKESH M,MANDURAI,31,Male
188,CSB24085,MADHUMITHA DEVI M,EDAMALAIPATTI PUDUR,18,Female
189,CSB24086,MAHA VIJAY SAROJ J A,"INFANT JESUS TEMPLE,THANJAVUR",15,Female
190,CSB24088,MAHALAKSHMI R,PALPANNAI,7,Female
191,CSB24089,MARY SUDHA S ,"KEELAVALADI, MALLIGAI NAGAR",34,Female
192,CSB24092,MERCY C,Kailash nagar,10,Female
193,CSB24093,MOGHISH T,BHEL,40,Male
194,CSB24094,MOHAMED ASIF SHAHAL S,Paalpannai,37,Male
195,CSB24095,MOHAMED GANI AARIF S A,T.V.S TOLLGATE,37,Male
196,CSB24096,MOHAMED HUMAYOON M,AMMAIAPPAN NAGAR,26,Male
197,CSB24097,MOHAMMAD ASHRAF M,THILLAI NAGAR 11TH CROSS,14,Male
198,CSB24099,MRETYUN JAI B,MANNARPURAM ,18,Male
199,CSB24100,MUZAKKIR AHAMED M,"ALWAR THOPPU STREET, PALAKARAI",8,Male
200,CSB24102,NAVEENKUMAR R K,SIRUGAMBUR,51,Male
201,CSB24103,NILA K,karumandapam,39,Female
202,CSB24105,NIRANJAN A,MARTHI NAGAR,5,Male
203,CSB24107,NISHA MEENATCHI S,PULLAMBADI.,15,Female
204,CSB24110,NITHILA K,MANTHURAI,31,Female
205,CSB24111,NITHIS R,SENGIPATTI,39,Male
206,CSB24115,PAVITHRA C,MARUTHI NAGAR,37,Female
207,CSB24116,PRADEEBA  S,Pillayar Kovil stop,17,Female
208,CSB24117,PRAGATHI V K,Sandapettai- lalgudi,31,Female
209,CSB24118,PRANAV P,"LAKSHMI COMPLEX,THILLAI NAGAR",14,Male
210,CSB24119,PRASHANTHINI T,Thombankudusai Thanjavur,50,Female
211,CSB24120,PRETHEV RAJ KUMARAN,Kk nagar,12,Male
212,CSB24122,PRITHISHA S,No: 1TOLLGATE,5,Female
213,CSB24124,PRIYANKA M,"THURAIYUR,PALAKKARAI",38,Female
214,CSB24125,PRIYANKA R,OFT,48,Female
215,CSC24128,RAKSHITHA R,Pullambadi,15,Female
216,CSC24131,RISHITHA U,Perambalur Palakarai,46,Female
217,CSC24132,RITHANYA A G,"RVB School,Thuraiyur",52,Female
218,CSC24133,ROHIN B,"Perabalur,New Bus stand",,Male
219,CSC24128,SAKTHIVEL K,Sanjeevi Nagar,13,Male
220,CSC24140,SARAN I,BHEL,32,Male
221,CSC24141,SARAN KUMAR SARAVANAMOORTHY,Airport,51,Male
222,CSC24142,SARANYA S,Kajamalai,17,Female
223,CSC24145,SHAAN RIFAA S,Uyyakondanthirumalai,30,Male
224,CSC24146,SHANMUGAPRIYA S,JeeyaPuram,32,Female
225,CSC24148,SHARJUN AHAMED S,Marakadai,52,Male
226,CSC24149,SHARMITHA S,Thuraiyur ,49,Female
227,CSC24150,SHELDON JOHN RODRIGUES J,"Anna Nagar, 2nd bus stand",48,Male
228,CSC24151,SHERYL BEULA MARTINA A,Palakarai,29,Female
229,CSC24152,SHIFANA S,Marakadai,29,Female
230,CSC24153,SIBIBALA M,Pudukkottai,47,Female
231,CSC24156,SONALI D S,Nadar Chatram,30,Female
232,CSC24157,SREE VIGNESH S,Mutharasanallur,20,Male
233,CSC24158,SRIHARIPPRIYA V,THALAKUDI,14,Female
234,CSC24163,SUBASHREE M,LALGUDI,23,Female
235,CSC24166,SURENDRAN MANIKANDAN,KK Nagar,12,Male
236,CSC24169,TAMIZHINIYAAN T,Beema nagar,19,Male
237,CSC24170,THABITHA SHERAHA A,RAMALINGA NAGR WORIUR,3,Female
238,CSC24171,THILAKESH S,KAILASH NAGAR,10,Male
239,CSC24172,THIRISHA P,PULLAMBADI.,15,Female
240,CSC24173,THIRUPPATHISAMY S,THIRUKKATTUPALLI,23,Male
241,CSC24174,USHA M,KONALAI BUS STOP,22,Female
242,CSC24176,VARSHINI G,THIRUVELLARAI,49,Female
243,CSC24178,VEDEESHA K M,KK NAGAR,12,Female
244,CSC24179,VIGNESH SRI R,THIRUVANAIKOVIL,48,Male
245,CSC24182,VISHWAJEET S,LALGUDI,31,Male
246,CSC24183,VISSHNU S J,SUBRAMANIYAPURAM,19,Male
247,CSC24187,YUVARAJ S,SELVANAGAR,7,Male
248,CSC24188,ZAINAB K,KK NAGAR,17,Female
249,ECA24002,ABINAYASRI S,THIRUVARAMBUR,35,Female
250,ECA24003,AHIL NIRRANJAN D,NACHIKURICHI,26,Male
251,ECA24004,ALBAR RAHMAN A,SUBRAMANIYAPURAM,19,Male
252,ECA24005,ANTRO JESVANTH V,SENTHANERPURAM,21,Male
253,ECA24006,ARUN E,THANJAVUR,50,Male
254,ECA24007,ARUN RAJ R,KARUMANDABAM,6,Male
255,ECA24010,ASHWITH R,LIC,17,Male
256,ECA24012,BHARATH K,SBI BANK,44,Male
257,ECA24014,CAUVIRISELVAN K,THANJAVUR/THOMBANKOTAI,50,Male
258,ECA24016,DHANUSH K,NAGAMANGALAM,18,Male
259,ECA24017,DHANUSH SHIVANI V,LALGUDI,23,Female
260,ECA24020,DHARSHAN B V,LIC,17,Male
261,ECA24021,DHARSHAN R,SIRUGAMBUR,51,Male
262,ECA24024,DICSON MOSES D,PULLAMBADI,15,Male
263,ECA24025,DINESH KUMAR S,THANJAVUR/THOMBANKOTAI,50,Male
264,ECA24026,DINESHKAR M,PALLAKARAI,8,Male
265,ECA24027,DINESHKUMAR D,KAJAMALAI,17,Male
266,ECA24029,EMIMA L A,PALLIVIDAI,5,Female
267,ECA24030,ENIYAVAN M,PUDUKKOTTAI,47,Male
268,ECA24031,ESWAR A,THANJAVUR,50,Male
269,ECA24032,FRANKLIN F,SENTHANERPURAM,17,Male
270,ECA24035,GOPIKA M,KATTUR,38,Female
271,ECA24037,GURUSAETH B,PONMALAIPATTY,21,Male
272,ECA24039,HARIHARAN S,THANJAVUR/THOMBANKOTAI,50,Male
273,ECA24040,HARINI P,RETTAIVAIKKAL,42,Female
274,ECA24042,INDHUMATHI S,MANNACHANCNULLR,44,Female
275,ECA24043,JAFRIN ANISHKA J,KAMBARASAMPATTAI,20,Female
276,ECA24044,JAIDEV S,MANNACHANCNULLR,44,Male
277,ECA24045,JAWAHAR K,DALMIPURAM,15,Male
278,ECA24046,JAWAHAR M,ARIYAMANGALAM,24,Male
279,ECA24047,JEEVA V,LIC,31,Male
280,ECA24049,JYOTHI SRI T,AIRPORT,19,Female
281,ECA24052,KAVINRAJ R,KEELVALADI,34,Male
282,ECA24054,KIRTHIK ROSHAN B,SINGARATHOOPU,25,Male
283,ECA24055,KISHORE R,ANNA VALAIVU,24,Male
284,ECA24056,KIYAZ MOHAMED S,PALLAKARAI,8,Male
285,ECA24058,KUMARAVEL V,MUSIRI,38,Male
286,ECA24059,LOGESHWARAN S,MANCHANALLUR,44,Male
287,ECA24060,MAGHATHI C,KOPU,9,Female
288,ECA24061,MAHALAKSHMI R,POOVALUR,31,Female
289,ECB24064,MANOJ PRASATH J,THIRUKKATTUPALLI,23,Male
290,ECB24065,MIRTHUN VIJAY A,LIC COLONY,17,Male
291,ECB24066,MOHAMED IZZATH S,PUDUKKOTTAI BUS STAND,47,Male
292,ECB24067,MOHAMMED RIYAZ N,WORAIYUR POLICE STATION,3,Male
293,ECB24068,MONICA. S,"THIRUVARAMBUR , KATTUR OILMILL BUS STOP",35,Female
294,ECB24069,MUTHURAMALINGAM PL,PUDUKKOTTAI,47,Male
295,ECB24071,NARESH S,SANJEEVI NAGAR,7,Male
296,ECB24073,NAVALATHI V,KATTUR,38,Female
297,ECB24074,NAVEEN A,KAJAMALAI,17,Male
298,ECB24076,NITHIN JOSHUA N M,KARUMANDAPAM,6,Male
299,ECB24077,NITHISH A,NOCHIYAM,5,Male
300,ECB24078,NITHISHWARAN M,THURAIYUR RVB SCHOOL,52,Male
301,ECB24079,NITHYA  SRI  A,ARIYAMANGALAM,24,Female
302,ECB24080,NIVETHASRI R S,THIRUVERUMBUR BUS STAND,35,Female
303,ECB24081,PRATHIKSHA P,EB STOP,14,Female
304,ECB24082,PRAVEEN R S,NO.TOLGATE,5,Male
305,ECB24083,PRAVEEN V,SUBRAMANIAPURAM,19,Male
306,ECB24085,PRIYADHARSHINI K,VELLANUR,31,Female
307,ECB24087,RAJASHREE S,"VELLANTHERU,KAMBARASAMPETTAI",20,Female
308,ECB24088,RAMA MADHAN,ANNA NAGAR,47,Male
309,ECB24090,SABARISH S,"MARUTI NAGAR, BIKSHANDARKOVIL ,",1,Male
310,ECB24091,SAKTHILAL M,EB STOP,48,Male
311,ECB24092,SANDHIYA K,KAVALKARAPALAYAM BUS STOP,32,Female
312,ECB24093,SANJANA D,,24,Female
313,ECB24096,SARUCHANDHRIKHA H,"MURUNGAPETTAI, MUTHARASANALLUR",32,Female
314,ECB24097,SHAM P,AIRPORT,4,Male
315,ECB24098,SHAMINI GENISIA D,KATTUR,38,Female
316,ECB24099,SHANMUGA PRIYAA  K,THUVAKUDI,39,Female
317,ECB24101,SHIVASHREE S,GEETHA NAGAR,30,Female
318,ECB24102,SHREYA M,"KARUR BYE PASS, LAXMI COMPLEX",14,Female
319,ECB24103,SHRI BASHYAM B S,MARAKADAI,46,Male
320,ECB24105,SIVARAMAN S,AYYAPPAN TEMPLE CANTONMENT TRICHY,14,Male
321,ECB24107,SREERAM M,LALGUDI,5,Male
322,ECB24108,SRI VARDHINI T,MARUTHI NAGAR,51,Female
323,ECB24111,SUDHARSEN A S,RAIL NAGAR,24,Male
324,ECB24113,SUJITHA M,ASOOR,39,Female
325,ECB24114,SUWATHI S,PUDUKKOTTAI,47,Female
326,ECB24115,SYED AJMAL S,"KADAIVITHI, WORAIYUR",42,Male
327,ECB24119,VEDHA VARSHINI S R,RAMANATHAN HOSPITAL,50,Female
328,ECB24126,YASWANTH V,SELVA NAGAR,14,Male
329,EE2407,ASWIN J,KALLUKUZHI,37,Male
330,EE2409,AVANTHIKA V E,MORAISCITY,19,Female
331,EE2410,BABU R,VELLANUR,15,Male
332,EE2411,BALAJI P,MANAJATHIDAL PAALAM,38,Male
333,EE2414,DANIEL D,MARUTHANDAKURICHI,9,Male
334,EE2415,DEEPAK LARA L,KK NAGAR,12,Male
335,EE2416,DEVADHARSHINI S,KAMABARASMPETTAI,20,Female
336,EE2418,DHIVYA PRAKASH V,KAILASH NAGAR,38,Female
337,EE2420,FREDRICK VIVILIAN R,MARSINGHPETTAI,29,Male
338,EE2423,HARIHARAN S,WORAIYUR,20,Male
339,EE2425,HARITHA B,KALYANICOVERING,25,Female
340,EE2426,JANAPRIYAN S,AANGARAI,34,Male
341,EE2429,JOTHISWAR B,INDIAN BANK COLONY,17,Male
342,EE2431,KATHIRVEL M,ALLUR COLONY,20,Male
343,EE2433,KEERTHANA S,ANNASALAI,1,Female
344,EE2434,KISHORE B,,29,Male
345,EE2437,LOKESH M,PONMALAI,19,Male
346,EE2439,MOHAMED FAISAL S,PALAKARAI,8,Male
347,EE2444,PRADHIBA S,TVKOVIL,41,Female
348,EE2445,PRANAVU R A,TVKOIL,37,Male
349,EE2446,PRAVIN KUMAR G,DALMIA,15,Male
350,EE2447,PRIYADHARSHINI S,KAMABARASMPETTAI,20,Female
351,EE2448,PRIYADHARSHINI S,THOMBANKUDUSAI,50,Female
352,EE2451,RESILA B,GANESA,10,Female
353,EE2454,SANJAI A,THARANALLUR,24,Male
354,EE2455,SANTHIYA M,TANJORE NEW BUSTSTAND,36,Female
355,EE2460,THERADI SANTHOSH M,KATTUR,38,Male
356,EE2461,VISHAAL M,BOILER PLANT,40,Male
357,EE2462,VISHAAL MULLAISELVAN,HOSTEL,17,Male
358,IT2403,ABIRAMI R,VEERESHWARAM,53,Female
359,IT2404,ADHITHII S P,Konar sathiram,30,Female
360,IT2405,AMUDESHWAR H,No- 1 tolgate,5,Male
361,IT2408,BHARANIDHARAN P,Uyyakundan Thirumalai,26,Male
362,IT2409,CHERMA SELVI A,Mannachanallur,44,Female
363,IT2410,DEEPANETHRA A,Kila valaadi,34,Female
364,IT2413,GOPINATHAN S,PERAMBALUR,46,Male
365,IT2415,HARINI ASHOK KUMAR,KARATTAMPATTI,49,Female
366,IT2416,HARIPRASATH G,KERALA HOSPITAL,9,Male
367,IT2417,HARISH K,LALKUDI,5,Male
368,IT2421,HARSHNI F,OFT,48,Female
369,IT2422,JANANI S,THILLAINAGAR,14,Female
370,IT2426,KEERTHIVASAN R P,Anna salai,1,Male
371,IT2427,LATHIKA C,"NEW BUS STAND, MUSURI",51,Female
372,IT2430,MANJARII SURENTHIRAN MALATHI,"LIC COLONY, KK NAGAR",12,Female
373,IT2431,MIRUTU BHASHINI S A,Uraiyur ,3,Female
374,IT2432,MOHAMEDFOZAN M,Paalpannai,24,Male
375,IT2436,NITHYA SREE M,Sathiram,1,Female
376,IT2437,NITYA NAGALAKSHIMI P,Lalgudi,31,Female
377,IT2439,PADMANABA GANESAN K,Malaikottai,29,Male
378,IT2440,PONVATHANA R,Lalgudi,23,Female
379,IT2442,PRASATH MUTHUKANNU S,Beema nagar,29,Male
380,IT2445,RITHIKHA B,Kalyani Cavering stop (malaikottai),25,Female
381,IT2448,SAHITHYA MIRUTHULA S,Thanjore,36,Female
382,IT2451,SHOBANA M,SOMARASAMPETTAI,30,Female
383,IT2452,SIVARANJANI S,Padalur,46,Female
384,IT2453,SUDHAN A,Uraiyur,3,Male
385,IT2455,SWETHA M,IRUR,46,Female
386,IT2457,THEJASHRI S,Uraiyur (KADAIVEETHI),42,Female
387,IT2460,VIGNESH SAI HARI M,VAYALUR,30,Male
388,IT2463,YUVARESH D,PERAMBALUR,46,Male
389,ME2403,ASWIN RAJA S,Thiriverumbur,35,Male
390,ME2405,BEGHAN RAJ G,TRAINING CENTER,40,Male
391,ME2406,BHUVANESH S,THIRUVERUMBUR,35,Male
392,ME2408,EZAIN RAYMENT J,OIL MILL,35,Male
393,ME2410,GOWTHAM S,SENTHANEERPURAM,11,Male
394,ME2411,GOWTHAM S,THUVAKUDI,48,Male
395,ME2412,HARISH K,Ponmalaipatti,27,Male
396,ME2413,HARISUDHAN B,Jeeyapuram,32,Male
397,ME2416,JEROME T,KEERANUR,47,Male
398,ME2421,KISHORE KUMAR R M,MALAIKOVIL,38,Male
399,ME2423,LOHIT PRAKASH J,TRAINING CENTER,40,Male
400,ME2425,MATHAN R R,PALAKKARAI,8,Male
401,ME2426,MOHAMED ZUBARULHAQ A,KK NAGAR,17,Male
402,ME2427,MOHANA GANESH B,KALYANI COVERING,25,Male
403,ME2428,MUKESH S,Kattur,29,Male
404,ME2430,MURALI KRISHNA R P,TIRUVANAI KOIL,7,Male
405,ME2431,MURUGESH G,Kailasa nagar,10,Male
406,ME2435,POOVARASAN D,"NARTHAMALAI,PUDUKOTTAI",31,Male
407,ME2437,PRASANTH A,SENTHANEERPURAM,11,Male
408,ME2438,PRAVEEN G,"NATCHIYAR KOVIL WORAIYUR, TRICHY",3,Male
409,ME2440,PRIYAN A,SENTHANEERPURAM,11,Male
410,ME2442,RAHUL NANDHAN N,THALLAKUDI,34,Male
411,ME2444,RITHAN V,BHEL,40,Male
412,ME2447,SAKTHIVEL R,LALGUID,31,Male
413,ME2452,Sengamala srivarshan S,"ALLAMPATTI ROAD,MANIKANDAM",39,Male
414,ME2454,SUREYAPRAKASH E V,"AALAMPATTI ROAD, MANIGANDAM",18,Male
415,ME2455,THARUN M,Rettaivaikkal,42,Male
416,ME2456,UGESH G,OIL MILL,35,Male
417,ME2457,VIGNESHWARAN S,ANGARAI,34,Male
418,ME2458,VIJAY KUMAR SELVAMURUGAN,MATHUR,48,Male
419,ME2459,VIJAYA RANGAN M,Chathram,14,Male
420,ME2461,VISVESWARAN R,THALLAKUDI,34,Male
`;


// minimal CSV parser to add students and routes dynamically
try {
  // prefer user-uploaded CSV in src/data if present (Uploaded filename: "Updated Bus comer list 2024-25.csv")
  const csvFilePath = path.join(process.cwd(), 'src', 'data', 'Updated Bus comer list 2024-25.csv');
  let csvToParse = csvText;
  if (fs.existsSync(csvFilePath)) {
    try {
      const fileBuffer = fs.readFileSync(csvFilePath);
      console.debug('CSV file size (bytes):', fileBuffer.length);
      csvToParse = fileBuffer.toString('utf8');
      console.debug('CSV raw content length:', csvToParse.length);
      // normalize header broken across lines like: BUS\nNO.
      csvToParse = csvToParse.replace(/BUS\r?\nNO\.?/gi, 'BUS NO.');
      // eslint-disable-next-line no-console
      console.debug('Using uploaded CSV at', csvFilePath);
    } catch (readE) {
      // eslint-disable-next-line no-console
      console.error('Failed to read uploaded CSV; falling back to embedded CSV:', readE && readE.message ? readE.message : readE);
    }
  }

  // NOTE: instead of concatenating the raw extraCsv string (which can
  // accidentally cause duplicates or be skipped), we'll parse the uploaded
  // CSV first and then parse the embedded `extraCsv` separately and merge
  // rows while deduplicating by student name. This ensures all rows from
  // both sources are considered regardless of minor string differences.

  // Read the entire CSV file, do not truncate or limit lines
  // Force Windows line ending split and log first/last lines for diagnosis
  // Always split lines using '\n' only to handle Unix line endings
  const lines = csvToParse.split('\n');
  console.debug('CSV line count after split:', lines.length);
  while (lines.length && !lines[lines.length - 1].trim()) lines.pop();
  // Debug: print first and last 5 lines
  console.debug('CSV first 5 lines:', lines.slice(0, 5));
  console.debug('CSV last 5 lines:', lines.slice(-5));

  // Lightweight CSV row parser that respects quoted fields
  function parseCsvRow(line) {
    const cols = [];
    let cur = '';
    let inQuotes = false;
    for (let i = 0; i < line.length; i++) {
      const ch = line[i];
      if (ch === '"') {
        if (inQuotes && i + 1 < line.length && line[i + 1] === '"') {
          // escaped quote
          cur += '"';
          i++;
        } else {
          inQuotes = !inQuotes;
        }
      } else if (ch === ',' && !inQuotes) {
        cols.push(cur);
        cur = '';
      } else {
        cur += ch;
      }
    }
    cols.push(cur);
    return cols.map((c) => c.replace(/^"|"$/g, '').trim());
  }

  // Find header line robustly by parsing each line and looking for NAME + BUS headers
  let headerIndex = -1;
  let headers = [];
  for (let li = 0; li < lines.length; li++) {
    const parsed = parseCsvRow(lines[li] || '');
    const norm = parsed.map((h) => (h || '').toString().toUpperCase());
    const hasName = norm.some((h) => /NAME/.test(h));
    const hasBus = norm.some((h) => /BUS/.test(h));
    if (hasName && hasBus) {
      headerIndex = li;
      headers = parsed.map((h) => (h || '').toString().replace(/"/g, '').trim());
      break;
    }
  }
  if (headerIndex >= 0) {
    console.debug('CSV header (line ' + headerIndex + '):', headers.join(','));
    console.debug('CSV total lines:', lines.length);
    // Robust column index detection using normalized header text
    const headerNorm = headers.map((h) => (h || '').toString().toUpperCase());
    let idxName = headerNorm.findIndex((h) => /NAME OF THE STUDENT/.test(h) || /NAME/.test(h));
    let idxBus = headerNorm.findIndex((h) => /BUS\s*NO\.?|BUS\s*NUMBER|BUS/.test(h));
    const idxMail = headerNorm.findIndex((h) => /MAIL/.test(h));
    let idxGender = headerNorm.findIndex((h) => /GENDER|SEX/.test(h));
    // fallback: if gender not found, try last columns heuristically
    if (idxGender === -1) {
      for (let back = headerNorm.length - 1; back >= 0; back--) {
        const h = headerNorm[back];
        if (h.length > 0 && /GENDER|SEX/.test(h)) { idxGender = back; break; }
      }
    }
    console.debug('CSV column indices:', { idxName, idxBus, idxMail, idxGender });

    const newRoutes = new Set();
    let parsedRows = 0;
    for (let i = headerIndex + 1; i < lines.length; i++) {
      const row = lines[i];
      if (!row) continue;
      try {
        const cols = parseCsvRow(row);
        const name = idxName >= 0 ? (cols[idxName] || '').trim() : '';
        if (!name && cols.every(c => !c)) continue;
        let busRaw = '';
        if (idxBus >= 0) {
          busRaw = cols[idxBus] || '';
          if (!/\d/.test(String(busRaw)) && idxBus + 1 < cols.length) {
            busRaw = cols[idxBus + 1] || '';
          }
        }
        const busMatch = String(busRaw).match(/\d+/);
        const routeNum = busMatch ? Number(busMatch[0]) : null;
        const mail = idxMail >= 0 && cols[idxMail] && cols[idxMail].includes('@') ? cols[idxMail] : null;
        const safe = name.toLowerCase().replace(/[^a-z0-9]+/g, '.').replace(/^\.|\.$/g, '');
        const generatedEmail = mail || `${safe || 'student'}@example.com`;
        const year = 2003;
        const mm = String(((i % 12) + 1)).padStart(2, '0');
        const dd = String(((i % 27) + 1)).padStart(2, '0');
        const dob = `${year}-${mm}-${dd}`;
        let gender = 'male';
        if (typeof idxGender === 'number' && idxGender >= 0) {
          const rawG = (cols[idxGender] || '').toString().trim().toLowerCase();
          if (rawG.startsWith('f')) gender = 'female';
          else if (rawG.startsWith('m')) gender = 'male';
          else if (/^f/.test(rawG)) gender = 'female';
        }
        const alreadyExists = students.some((s) => s.name === name);
        if (alreadyExists) continue;
        const newStudent = {
          id: uuidv4(),
          name: name,
          email: generatedEmail,
          dob,
          role: 'student',
          route: routeNum,
          gender,
          seatNumber: null,
          paid: false,
        };
        // sanitize emails from the registrar domain to avoid exposing real PII in dev
        try {
          if (newStudent.email && /@krct\.ac\.in$/i.test(newStudent.email)) {
            newStudent.email = newStudent.email.replace(/@krct\.ac\.in$/i, '@example.com');
          }
        } catch (e) {}
        // For dev/testing: give a deterministic DOB. Mark some students as paid so tests can exercise both states.
        try {
          newStudent.dob = '2003-01-01';
          // If DEV_FORCE_PAID=true, force everyone paid (convenience). Otherwise, mark a deterministic subset as paid
          // so tests see both paid and unpaid users. We use the CSV row index 'i' to pick roughly 1-in-4 students.
          if (process && process.env && String(process.env.DEV_FORCE_PAID).toLowerCase() === 'true') {
            newStudent.paid = true;
          } else {
            try {
              newStudent.paid = (i % 4 === 0);
            } catch (e) {
              // if 'i' is not available for some reason, default to false
              newStudent.paid = false;
            }
          }
        } catch (e) {}
        students.push(newStudent);
        if (routeNum) newRoutes.add(routeNum);
        parsedRows++;
      } catch (rowErr) {
        console.error(`CSV row parse error at line ${i + 1}:`, row, rowErr && rowErr.message ? rowErr.message : rowErr);
      }
    }
    // Now also parse the embedded extraCsv (if present) to ensure any
    // rows that the uploaded CSV doesn't include are still imported.
    if (typeof extraCsv === 'string' && extraCsv.trim()) {
      const extraLines = extraCsv.split('\n').map(l => l.trim()).filter(Boolean);
      // find header in extraCsv similarly
      let extraHeaderIndex = -1;
      let extraHeaders = [];
      for (let li = 0; li < extraLines.length; li++) {
        const parsed = parseCsvRow(extraLines[li] || '');
        const norm = parsed.map((h) => (h || '').toString().toUpperCase());
        const hasName = norm.some((h) => /NAME/.test(h));
        const hasBus = norm.some((h) => /BUS/.test(h));
        if (hasName && hasBus) {
          extraHeaderIndex = li;
          extraHeaders = parsed;
          break;
        }
      }
      if (extraHeaderIndex >= 0) {
        for (let i = extraHeaderIndex + 1; i < extraLines.length; i++) {
          const row = extraLines[i];
          if (!row) continue;
          try {
            const cols = parseCsvRow(row);
            const name = idxName >= 0 ? (cols[idxName] || '').trim() : '';
            if (!name && cols.every(c => !c)) continue;
            let busRaw = '';
            if (idxBus >= 0) {
              busRaw = cols[idxBus] || '';
              if (!/\d/.test(String(busRaw)) && idxBus + 1 < cols.length) {
                busRaw = cols[idxBus + 1] || '';
              }
            }
            const busMatch = String(busRaw).match(/\d+/);
            const routeNum = busMatch ? Number(busMatch[0]) : null;
            const mail = idxMail >= 0 && cols[idxMail] && cols[idxMail].includes('@') ? cols[idxMail] : null;
            const safe = name.toLowerCase().replace(/[^a-z0-9]+/g, '.').replace(/^\.|\.$/g, '');
            const generatedEmail = mail || `${safe || 'student'}@example.com`;
            const year = 2003;
            const mm = String(((i % 12) + 1)).padStart(2, '0');
            const dd = String(((i % 27) + 1)).padStart(2, '0');
            const dob = `${year}-${mm}-${dd}`;
            let gender = 'male';
            if (typeof idxGender === 'number' && idxGender >= 0) {
              const rawG = (cols[idxGender] || '').toString().trim().toLowerCase();
              if (rawG.startsWith('f')) gender = 'female';
              else if (rawG.startsWith('m')) gender = 'male';
              else if (/^f/.test(rawG)) gender = 'female';
            }
            const alreadyExists = students.some((s) => s.name === name);
            if (alreadyExists) continue;
            const newStudent = {
              id: uuidv4(),
              name: name,
              email: generatedEmail,
              dob,
              role: 'student',
              route: routeNum,
              gender,
              seatNumber: null,
              paid: false,
            };
            // sanitize emails from the registrar domain to avoid exposing real PII in dev
            try {
              if (newStudent.email && /@krct\.ac\.in$/i.test(newStudent.email)) {
                newStudent.email = newStudent.email.replace(/@krct\.ac\.in$/i, '@example.com');
              }
            } catch (e) {}
            // For dev/testing: give a deterministic DOB. Mark some students as paid so tests can exercise both states.
            try {
              newStudent.dob = '2003-01-01';
              if (process && process.env && String(process.env.DEV_FORCE_PAID).toLowerCase() === 'true') {
                newStudent.paid = true;
              } else {
                try {
                  newStudent.paid = (i % 4 === 0);
                } catch (e) {
                  newStudent.paid = false;
                }
              }
            } catch (e) {}
            students.push(newStudent);
            if (routeNum) newRoutes.add(routeNum);
            parsedRows++;
          } catch (rowErr) {
            console.error(`extraCsv row parse error at line ${i + 1}:`, row, rowErr && rowErr.message ? rowErr.message : rowErr);
          }
        }
      }
    }
    // create placeholder routes for any bus numbers found
    const existingRouteNumbers = new Set(routes.map((r) => r.number));
    Array.from(newRoutes).forEach((rnum) => {
      if (!existingRouteNumbers.has(rnum)) {
        const driverName = `Driver ${rnum}`;
        drivers.push({ id: uuidv4(), name: driverName, phone: null, license: null });
        routes.push({ id: uuidv4(), number: rnum, name: String(rnum), origin: 'College', destination: `Route ${rnum}`, busNumber: `BUS-${rnum}`, driver: driverName, capacity: 57 });

        // Ensure each route has a faculty assigned. If the staff array
        // already contains someone assigned to this route, keep them.
        // Otherwise synthesize a lightweight faculty record so the UI and
        // seating logic can show a faculty for every bus.
        const existingFaculty = staff.find((s) => s && s.route === rnum);
        if (!existingFaculty) {
          const facultyName = `Faculty ${rnum}`;
          // give synthesized faculty a default DOB so they can log in in dev
          staff.push({ id: uuidv4(), name: facultyName, email: `faculty${rnum}@example.com`, dob: '1980-01-01', role: 'staff', route: rnum });
        }
      }
    });

    // Assign a single coordinator per route: prefer existing staff with role 'staff'
    // and not already marked as coordinator. We will mark coordinator by setting
    // role = 'coordinator' on that staff record. If no staff exists for the route,
    // create a Coordinator placeholder.
    Array.from(newRoutes).forEach((rnum) => {
      const staffsForRoute = staff.filter(s => s && s.route === rnum);
      let coordinator = staffsForRoute.find(s => s && s.role === 'coordinator');
      if (!coordinator) {
        // pick an existing staff (round-robin by hash) or synthesize
        if (staffsForRoute.length > 0) {
          // pick the first available staff and mark them coordinator
          staffsForRoute[0].role = 'coordinator';
        } else {
          // synthesize coordinator (give default DOB for dev/testing)
          const coordName = `Coordinator ${rnum}`;
          staff.push({ id: uuidv4(), name: coordName, email: `coord${rnum}@example.com`, dob: '1980-01-01', role: 'coordinator', route: rnum });
        }
      }
    });
    // debug: report how many students were parsed and how many have routes
    console.debug(`CSV import: parsed ${students.length} students; ${Array.from(newRoutes).length} distinct route numbers found; with route: ${students.filter(s => typeof s.route === 'number' && !Number.isNaN(s.route)).length}`);
    console.debug(`CSV import: parsedRows=${parsedRows}`);
  }
} catch (e) {
  // parsing shouldn't crash the module; if it does, leave the dataset as-is and log to console
  // eslint-disable-next-line no-console
  console.error('CSV import failed:', e && e.message ? e.message : e);
}
// --- End CSV import -----------------------------------------------------

// Remove any students who don't have a numeric bus route (hostel / no clear bus data)
// We mutate the students array in-place so other modules importing this file see the cleaned list.
// Do NOT filter out students without a numeric bus route. Keep all parsed students.

// Helper: in-place Fisherâ€“Yates shuffle
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    const tmp = array[i];
    array[i] = array[j];
    array[j] = tmp;
  }
}

// Attach students and staff to their routes (so each route has a `students` and `staff` array)
routes.forEach((r) => {
  r.students = students.filter((s) => s.route === r.number);
  r.staff = staff.filter((f) => f.route === r.number);
});

// Add driver name directly onto each student and staff object for easy display in the seats UI
const _routeMap = new Map(routes.map((r) => [r.number, r]));
students.forEach((s) => {
  const route = _routeMap.get(s.route);
  s.driver = route ? route.driver : null;
  s.busNumber = route ? route.busNumber : null;
});
staff.forEach((f) => {
  const route = _routeMap.get(f.route);
  f.driver = route ? route.driver : null;
  f.busNumber = route ? route.busNumber : null;
});

// Ensure every route has capacity (default 57). We do NOT synthesize extra students when a CSV is provided.
routes.forEach((r) => {
  r.capacity = r.capacity || 57;
  r.students = r.students || [];
  r.staff = r.staff || [];
});

// Assign seat numbers per-route grouping staff, then girls in front, then boys in rear.
// Seat counts are based on each route's configured capacity (r.capacity).
routes.forEach((r) => {
  const capacity = Number(r.capacity) || 57;
  const studentsOnRoute = r.students || [];

  // group students by gender so we place girls first, then boys
  const girls = studentsOnRoute.filter((s) => s.gender === 'female');
  const boys = studentsOnRoute.filter((s) => s.gender === 'male');
  const others = studentsOnRoute.filter((s) => !s.gender);

  // shuffle within groups to avoid deterministic seating
  shuffle(girls);
  shuffle(boys);
  shuffle(others);

  // clear existing seatNumbers so we enforce grouping (user requested strict separation)
  studentsOnRoute.forEach((st) => {
    st.seatNumber = null;
  });
  (r.staff || []).forEach((sf) => {
    sf.seatNumber = null;
  });

  // We will NOT reserve front seats for staff here. Per request, the first
  // block of seats should be for girls (seats 1..20). Staff will remain
  // unassigned (null) so they do not occupy student-facing seats.
  let seatCursor = 1;
  const staffList = r.staff || [];
  for (let i = 0; i < staffList.length; i++) {
    staffList[i].seatNumber = null;
  }

  // Remaining seats after staff
  const seatsLeftAfterStaff = capacity - (seatCursor - 1);
  if (seatsLeftAfterStaff <= 0) return; // nothing left to assign

  // 2) Assign girls into a fixed front block.
  // Per request: reserve the first 5 seats for staff, then allocate the next up to
  // 20 seats for girls (i.e., seats 6..25 when capacity allows). This guarantees
  // girls occupy the front section; boys will be placed after this block.
  let seatsLeft = capacity - (seatCursor - 1);
  const girlsBlockSize = Math.min(20, seatsLeft); // maximum seats reserved for girls
  const girlsToAssign = Math.min(girls.length, girlsBlockSize);
  for (let i = 0; i < girlsToAssign; i++) {
    const g = girls[i];
    g.seatNumber = seatCursor++;
  }

  // recompute seats left after girls block
  // If fewer girls than the front block size, leave the remaining seats in the
  // girls block unassigned so boys are placed after the full girls block.
  const gap = girlsBlockSize - girlsToAssign;
  if (gap > 0) {
    // advance the cursor to skip the unfilled girls block seats
    seatCursor += gap;
  }
  seatsLeft = capacity - (seatCursor - 1);
  if (seatsLeft <= 0) return;

  // 3) Assign boys into the remaining seats (immediately after the girls block)
  const boysToAssign = Math.min(boys.length, seatsLeft);
  for (let i = 0; i < boysToAssign; i++) {
    const b = boys[i];
    b.seatNumber = seatCursor++;
  }

  seatsLeft = capacity - (seatCursor - 1);
  if (seatsLeft <= 0) return;

  // 4) Assign any remaining others (no gender) into remaining seats
  for (let i = 0; i < others.length && seatsLeft > 0; i++) {
    others[i].seatNumber = seatCursor++;
    seatsLeft--;
  }

  // If there are still unassigned students (overflow beyond capacity), leave seatNumber null
});

// Export buses as an alias for routes for clarity
export const buses = routes;

// Ensure every student object has a `paid` boolean (default false) for backwards compatibility
students.forEach((s) => {
  if (typeof s.paid === 'undefined') s.paid = false;
});

